<!DOCTYPE html>
<html lang="he" dir="rtl">

<head>
  <meta charset="utf-8">
  <title>Collaboration map</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://unpkg.com/maplibre-gl@5.1.0/dist/maplibre-gl.css" rel="stylesheet" />
  <script src="https://unpkg.com/maplibre-gl@5.1.0/dist/maplibre-gl.js"></script>
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="Media.css">
</head>

<body>

  <!-- LOGIN SCREEN -->
  <div id="login-screen" class="login-screen">
    <div class="login-box">
      <div class="brand">
        <div class="logo"></div>
        <div class="brand-text">
          <div class="brand-title">InoviteFuture (NebulaU)</div>
          <div class="brand-sub">School Mapping Administration</div>
        </div>
      </div>

      <h2>Administrator login</h2>
      <p>A management system for mapping schools in the country and the connections between them</p>

      <div class="input-wrap">
        <span class="input-icon" aria-hidden="true">ðŸ”’</span>
        <input id="passwordInput" type="password" placeholder="Password" />
      </div>

      <button id="loginBtn">Enter</button>

      <div id="loginError" class="login-error"></div>

      <div class="login-footnote">Access for authorized users only!</div>
    </div>
  </div>

  <!-- APP (hidden until login) -->
  <div id="app" style="display:none;">

    <div id="map"></div>

    <div class="controls">
      <div class="control-group">
        <h4>Filters:</h4>
        <button data-proj="globe">globes</button>
        <button data-proj="mercator" class="active">Mercator</button>
      </div>

      <div class="control-group">
        <h4>Base layer</h4>
        <button data-style="standard" class="active">Normal</button>
        <button data-style="satellite">Satellite</button>
        <button data-style="osm">OSM</button>
      </div>

      <div class="control-group">
        <h4>×©×›×‘×•×ª</h4>
        <div class="checkbox-group">
          <label><input type="checkbox" class="amenity" value="school" checked>Schools</label>
          <label><input type="checkbox" class="amenity" value="kindergarten" checked>Kindergartens</label>
          <label><input type="checkbox" class="amenity" value="college" checked>Colleges</label>
          <label><input type="checkbox" class="amenity" value="university" checked>Universities</label>
        </div>

        <div class="button-group">
          <button id="toggle-edu" class="active">Institutions</button>
          <button id="toggle-labels" class="active">Labels</button>
        </div>
      </div>

      <div class="control-group">
        <h4>Search</h4>
        <input id="q" placeholder="Look for a place..." />
      </div>
    </div>

    <aside id="side-menu" class="side-menu">
      <div class="side-header">
        <h3>
          Youth departments
          <span id="cityCount" style="font-size:12px;opacity:.7;"></span>
        </h3>

        <label class="field">
          <span>City search</span>
          <input id="citySearch" placeholder="Type a city name..." />
        </label>

        <div class="filters">
          <label class="field">
            <span>District</span>
            <select id="districtFilter">
              <option value="">All</option>
            </select>
          </label>

          <label class="field">
            <span>Region/Sector</span>
            <select id="sectorFilter">
              <option value="">All</option>
            </select>
          </label>
        </div>
      </div>

      <div class="side-body">
        <ul id="cityList" class="city-list"></ul>
      </div>

      <div class="side-footer">
        <div id="cityDetails" class="city-details">
          <div class="muted">Click on the city to see details!</div>
        </div>
      </div>
    </aside>

    <div id="loading"></div>
    <div id="toast"></div>
  </div>

  <script>
    const PASSWORD = atob("QmxhY2tXb2xm");

    const loginScreen = document.getElementById("login-screen");
    const app = document.getElementById("app");
    const input = document.getElementById("passwordInput");
    const btn = document.getElementById("loginBtn");
    const error = document.getElementById("loginError");

    function tryLogin() {
      error.classList.remove("show");

      if (input.value === PASSWORD) {
        loginScreen.classList.add("exit");
        setTimeout(() => {
          loginScreen.style.display = "none";
          app.style.display = "block";
        }, 400);
      } else {
        error.textContent = "Wrong password";
        error.classList.add("show");
        input.classList.add("shake");
        input.value = "";
        input.focus();
        setTimeout(() => input.classList.remove("shake"), 400);
      }
    }

    btn.addEventListener("click", tryLogin);
    input.addEventListener("keydown", e => {
      if (e.key === "Enter") tryLogin();
    });

    function makeDraggable(element) {
      let isDragging = false;
      let offsetX = 0;
      let offsetY = 0;

      element.addEventListener("mousedown", (e) => {
        isDragging = true;
        element.classList.add("dragging");

        const rect = element.getBoundingClientRect();
        offsetX = e.clientX - rect.left;
        offsetY = e.clientY - rect.top;
      });

      document.addEventListener("mousemove", (e) => {
        if (!isDragging) return;

        element.style.left = (e.clientX - offsetX) + "px";
        element.style.top = (e.clientY - offsetY) + "px";
      });

      document.addEventListener("mouseup", () => {
        isDragging = false;
        element.classList.remove("dragging");
      });
    }

    makeDraggable(document.querySelector(".controls"));
    makeDraggable(document.querySelector(".side-menu"));    
  </script>

  <!-- ðŸš€ MAIN APP -->
  <script type="module" src="./Java%20files/main.js"></script>

</body>
</html>
